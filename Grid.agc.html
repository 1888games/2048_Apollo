<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
<title>Assembly listing generated by yaYUL</title>
<style type="text/css">
p.nobreak { white-space:nowrap; }
a { text-decoration:none; }
a:visited { COLOR: #000850; }
</style>
<style type="text/css">
.op{
font-weight: bold;
color: #993300;
}
</style>
<style type="text/css">
.dn{
color: #009900;
}
</style>
<style type="text/css">
.fe{
color: #FF0000;
}
</style>
<style type="text/css">
.in{
color: #FF6600;
}
</style>
<style type="text/css">
.ps{
color: #336600;
}
</style>
<style type="text/css">
.sm{
color: #0000FF;
}
</style>
<style type="text/css">
.wn{
color: #FF9900;
}
</style>
<style type="text/css">
.co{
font-style: italic;
color: #993399;
}
</style>
</head>
<body>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
<h1>Source Code</h1>
000111,000001: 
<a name="5245534554414C4C"></a>000112,000002:    4102                        <span class="sm">RESETALL</span>                                                          
000113,000003: 
000114,000004:    4102           35142                           <span class="op">CA      </span> <a href="Constants.agc.html#5457454E545931">TWENTY1</a>                               <span class="co">#  Set loop counter to 21</span>
000115,000005:    4103           54075                           <span class="op">TS      </span> <a href="Ram.agc.html#4355525F4944">CUR_ID</a>                                
<a name="52455345544C4F4F"></a>000116,000006:    4104                        <span class="sm">RESETLOOP</span>                                                          
000117,000007:    4104           35140                           <span class="op">CA      </span> <a href="Constants.agc.html#4E45475F4F4E45">NEG_ONE</a>                               <span class="co">#  Load -1 to A (empty cell)</span>
000118,000008:    4105           50075                           <span class="op">INDEX   </span> <a href="Ram.agc.html#4355525F4944">CUR_ID</a>                                <span class="co">#  Index by current loop count</span>
000119,000009:    4106           54124                           <span class="op">TS      </span> <a href="Ram.agc.html#56414C554553">VALUES</a>                                <span class="co">#  Save -1 to empty this grid cell</span>
000120,000010: 
000121,000011:    4107           00006                           <span class="op">EXTEND  </span>                                       
000122,000012:    4110           26075                           <span class="op">DIM     </span> <a href="Ram.agc.html#4355525F4944">CUR_ID</a>                                <span class="co">#  Decrement loop counter</span>
000123,000013:    4111           30075                           <span class="op">CA      </span> <a href="Ram.agc.html#4355525F4944">CUR_ID</a>                                <span class="co">#  Load loop counter</span>
000124,000014:    4112           00006                           <span class="op">EXTEND  </span>                                       
000125,000015:    4113           14115                           <span class="op">BZF     </span> <a href="#5245534554454E44">RESETEND</a>                              <span class="co">#  If zero, we've cleared all of VALUES array</span>
000126,000016: 
000127,000017:    4114           14104                           <span class="op">TCF     </span> <a href="#52455345544C4F4F">RESETLOOP</a>                             <span class="co">#  Not zero, loop back for next cell</span>
000128,000018: 
000129,000019: 
<a name="5245534554454E44"></a>000130,000020:    4115                        <span class="sm">RESETEND</span>                                                          
000131,000021:    4115           00002                           <span class="op">RETURN  </span>                                       <span class="co">#  Return to Init</span>
000132,000022: 
000133,000023: 
<a name="5345434F4E44"></a>000134,000024:    4116                        <span class="sm">SECOND  </span>                                                          
000135,000025: 
000136,000026:    4116           24073                           <span class="op">INCR    </span> <a href="Ram.agc.html#414354495645">ACTIVE</a>                                <span class="co">#  Set game to active now two cells will be populated</span>
<a name="4E45574E554D"></a>000137,000027:    4117                        <span class="sm">NEWNUM  </span>                                                          
000138,000028: 
000139,000029:    4117           04775                           <span class="op">TC      </span> <a href="Display.agc.html#494F44454C4159">IODELAY</a>                               <span class="co">#  Delay a bit before generating the number</span>
000140,000030:    4120           04131                           <span class="op">TC      </span> <a href="#47454E5A45524F">GENZERO</a>                               <span class="co">#  Call function to generate a 0 or 1 in empty cell</span>
000141,000031:    4121           04703                           <span class="op">TC      </span> <a href="Display.agc.html#444953503135">DISP15</a>                                <span class="co">#  Call function Display the new grid state</span>
000142,000032: 
000143,000033:    4122           30073                           <span class="op">CA      </span> <a href="Ram.agc.html#414354495645">ACTIVE</a>                                <span class="co">#  Load whether game is active</span>
000144,000034:    4123           00006                           <span class="op">EXTEND  </span>                                       
000145,000035:    4124           14116                           <span class="op">BZF     </span> <a href="#5345434F4E44">SECOND</a>                                <span class="co">#  If not, generate another new number</span>
000146,000036: 
000147,000037:    4125           04775                           <span class="op">TC      </span> <a href="Display.agc.html#494F44454C4159">IODELAY</a>                               <span class="co">#  Delay before returning control to player</span>
000148,000038: 
000149,000039:    4126           35253                           <span class="op">CA      </span> <a href="Tables.agc.html#5354415F494E5055">STA_INPUT</a>                             <span class="co">#  Change game state to player control</span>
000150,000040:    4127           54101                           <span class="op">TS      </span> <a href="Ram.agc.html#474D5F5354415445">GM_STATE</a>                              
000151,000041: 
000152,000042:    4130           14070                           <span class="op">TCF     </span> <a href="Main.agc.html#4D41494E4C4F4F50">MAINLOOP</a>                              <span class="co">#  Return to start of game loop</span>
000153,000043: 
000154,000044: 
000155,000045: 
<a name="47454E5A45524F"></a>000156,000046:    4131                        <span class="sm">GENZERO </span>                                                          <span class="co">#  Generate a 0 or 1 in an empty grid cell</span>
000157,000047:    4131           00006                           <span class="op">EXTEND  </span>                                       
000158,000048:    4132           22072                           <span class="op">QXCH    </span> <a href="Ram.agc.html#5245545F41445232">RET_ADR2</a>                              <span class="co">#  Save the return address of the calling function</span>
000159,000049: 
000160,000050: 
<a name="4E4557424F58"></a>000161,000051:    4133                        <span class="sm">NEWBOX  </span>                                                          
000162,000052: 
000163,000053:    4133           35144                           <span class="op">CA      </span> <a href="Constants.agc.html#4D41534B3135">MASK15</a>                                <span class="co">#  Load a mask to keep only the bottom 4 bits</span>
000164,000054:    4134           54061                           <span class="op">TS      </span> <a href="Ram.agc.html#54454D5049">TEMPI</a>                                 <span class="co">#  Store into temp variable</span>
000165,000055: 
000166,000056:    4135           05120                           <span class="op">TC      </span> <a href="Random.agc.html#52414E444F4D">RANDOM</a>                                <span class="co">#  Get a random number (and discard)</span>
000167,000057:    4136           30074                           <span class="op">CA      </span> <a href="Ram.agc.html#434F554E544552">COUNTER</a>                               <span class="co">#  Load the random number counter (0-127)</span>
000168,000058:    4137           75144                           <span class="op">MASK    </span> <a href="Constants.agc.html#4D41534B3135">MASK15</a>                                <span class="co">#  Mask it down to 0-15</span>
000169,000059:    4140           54123                           <span class="op">TS      </span> <a href="Ram.agc.html#504C41595F4944">PLAY_ID</a>                               <span class="co">#  Store it as the grid cell to try and add to</span>
000170,000060:    4141           00006                           <span class="op">EXTEND  </span>                                       
000171,000061:    4142           60061                           <span class="op">SU      </span> <a href="Ram.agc.html#54454D5049">TEMPI</a>                                 <span class="co">#  Subtract 15 from this cell number</span>
000172,000062:    4143           00006                           <span class="op">EXTEND  </span>                                       
000173,000063:    4144           14150                           <span class="op">BZF     </span> <a href="#41444435">ADD5</a>                                  <span class="co">#  If is 0, we have cell 16 and there only 15.</span>
000174,000064: 
<a name="41444436"></a>000175,000065:    4145                        <span class="sm">ADD6    </span>                                                          <span class="co">#  Is not 0, we can safely add grid offset of 6</span>
000176,000066: 
000177,000067:    4145           30123                           <span class="op">CA      </span> <a href="Ram.agc.html#504C41595F4944">PLAY_ID</a>                               <span class="co">#  Load the number we know is from 0-14</span>
000178,000068:    4146           65261                           <span class="op">AD      </span> <a href="Tables.agc.html#44454336">DEC6</a>                                  <span class="co">#  Add 6 to get the first display segment in the grid</span>
000179,000069: 
000180,000070:    4147           14152                           <span class="op">TCF     </span> <a href="#43484B56414C4944">CHKVALID</a>                              <span class="co">#  Now check whether this grid cell is empty</span>
000181,000071: 
<a name="41444435"></a>000182,000072:    4150                        <span class="sm">ADD5    </span>                                                          
000183,000073:    4150           30123                           <span class="op">CA      </span> <a href="Ram.agc.html#504C41595F4944">PLAY_ID</a>                               <span class="co">#  We know the number is 15</span>
000184,000074:    4151           65260                           <span class="op">AD      </span> <a href="Tables.agc.html#44454335">DEC5</a>                                  <span class="co">#  So only add 5 so we still get a valid cell</span>
000185,000075: 
<a name="43484B56414C4944"></a>000186,000076:    4152                        <span class="sm">CHKVALID</span>                                                          
000187,000077: 
000188,000078:    4152           54123                           <span class="op">TS      </span> <a href="Ram.agc.html#504C41595F4944">PLAY_ID</a>                               <span class="co">#  Store the cell id to check is empty</span>
000189,000079:    4153           50123                           <span class="op">INDEX   </span> <a href="Ram.agc.html#504C41595F4944">PLAY_ID</a>                               <span class="co">#  Index by the cell id</span>
000190,000080:    4154           30124                           <span class="op">CA      </span> <a href="Ram.agc.html#56414C554553">VALUES</a>                                <span class="co">#  Get the value held for cell in VALUES array</span>
000191,000081:    4155           65254                           <span class="op">AD      </span> <a href="Tables.agc.html#44454331">DEC1</a>                                  <span class="co">#  Add one, if it was empty (-1) it's now zero'</span>
000192,000082:    4156           00006                           <span class="op">EXTEND  </span>                                       
000193,000083:    4157           14162                           <span class="op">BZF     </span> <a href="#4953454D505459">ISEMPTY</a>                               <span class="co">#  If empty, we can use this cell for new number</span>
000194,000084: 
<a name="4E4F54454D505459"></a>000195,000085:    4160                        <span class="sm">NOTEMPTY</span>                                                          
000196,000086: 
000197,000087:    4160           54067                           <span class="op">TS      </span> <a href="Ram.agc.html#4E45574A4F42">NEWJOB</a>                                <span class="co">#  Nudge watchdog in case it takes a while to find cell</span>
000198,000088:    4161           14133                           <span class="op">TCF     </span> <a href="#4E4557424F58">NEWBOX</a>                                <span class="co">#  We can't use this cell, try again</span>
000199,000089: 
<a name="4953454D505459"></a>000200,000090:    4162                        <span class="sm">ISEMPTY </span>                                                          
000201,000091: 
000202,000092:    4162           05120                           <span class="op">TC      </span> <a href="Random.agc.html#52414E444F4D">RANDOM</a>                                <span class="co">#  Get a random number from 0-9</span>
000203,000093:    4163           54061                           <span class="op">TS      </span> <a href="Ram.agc.html#54454D5049">TEMPI</a>                                 <span class="co">#  Save to temp variable</span>
000204,000094:    4164           35257                           <span class="op">CA      </span> <a href="Tables.agc.html#44454334">DEC4</a>                                  <span class="co">#  Load 4 into A</span>
000205,000095:    4165           00006                           <span class="op">EXTEND  </span>                                       
000206,000096:    4166           60061                           <span class="op">SU      </span> <a href="Ram.agc.html#54454D5049">TEMPI</a>                                 <span class="co">#  Subtract 0-9 from 5</span>
000207,000097:    4167           00006                           <span class="op">EXTEND  </span>                                       
000208,000098:    4170           64173                           <span class="op">BZMF    </span> <a href="#4D414B454F4E45">MAKEONE</a>                               <span class="co">#  if zero or negative, make cell = 1</span>
000209,000099: 
000210,000100:    4171           30007                           <span class="op">CA      </span> <a href="Constants.agc.html#5A45524F">ZERO</a>                                  <span class="co">#  is >0, make cell = 0</span>
000211,000101:    4172           14174                           <span class="op">TCF     </span> <a href="#53544F52454E4557">STORENEW</a>                              
000212,000102: 
<a name="4D414B454F4E45"></a>000213,000103:    4173                        <span class="sm">MAKEONE </span>                                                          
000214,000104:    4173           35254                           <span class="op">CA      </span> <a href="Tables.agc.html#44454331">DEC1</a>                                  <span class="co">#  Load 1 into A</span>
000215,000105: 
<a name="53544F52454E4557"></a>000216,000106:    4174                        <span class="sm">STORENEW</span>                                                          
000217,000107: 
000218,000108:    4174           50123                           <span class="op">INDEX   </span> <a href="Ram.agc.html#504C41595F4944">PLAY_ID</a>                               <span class="co">#  Index by chosen cell ID</span>
000219,000109:    4175           54124                           <span class="op">TS      </span> <a href="Ram.agc.html#56414C554553">VALUES</a>                                <span class="co">#  Store 0-1 into values array by index</span>
000220,000110: 
000221,000111:    4176           00006                           <span class="op">EXTEND  </span>                                       
000222,000112:    4177           22072                           <span class="op">QXCH    </span> <a href="Ram.agc.html#5245545F41445232">RET_ADR2</a>                              <span class="co">#  Restore return address of calling func</span>
000223,000113: 
000224,000114:    4200           00002                           <span class="op">RETURN  </span>                                       <span class="co">#  Return to NEWNUM</span>

End of include-file Grid.agc.  Parent file is <a href="Main.agc.html">Main.agc</a>
</pre>
</span>
</p>
</body>
</html>
