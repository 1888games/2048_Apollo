<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
<title>Assembly listing generated by yaYUL</title>
<style type="text/css">
p.nobreak { white-space:nowrap; }
a { text-decoration:none; }
a:visited { COLOR: #000850; }
</style>
<style type="text/css">
.op{
font-weight: bold;
color: #993300;
}
</style>
<style type="text/css">
.dn{
color: #009900;
}
</style>
<style type="text/css">
.fe{
color: #FF0000;
}
</style>
<style type="text/css">
.in{
color: #FF6600;
}
</style>
<style type="text/css">
.ps{
color: #336600;
}
</style>
<style type="text/css">
.sm{
color: #0000FF;
}
</style>
<style type="text/css">
.wn{
color: #FF9900;
}
</style>
<style type="text/css">
.co{
font-style: italic;
color: #993399;
}
</style>
</head>
<body>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
<h1>Source Code</h1>
<a name="4B45595255505431"></a>000928,000001:    5014                        <span class="sm">KEYRUPT1</span>                                                          <span class="co">#  Triggered automatically when a key is pressed</span>
000929,000002: 
000930,000003:    5014           35130                           <span class="op">CA      </span> <a href="Constants.agc.html#4E4F4B4559">NOKEY</a>                                 <span class="co">#  Load code for 'NO KEY PRESSED'</span>
000931,000004:    5015           54070                           <span class="op">TS      </span> <a href="Ram.agc.html#4B4559425546">KEYBUF</a>                                <span class="co">#  Clear key buffer so we don't persist presses from when they are not wanted</span>
000932,000005: 
000933,000006:    5016           30073                           <span class="op">CA      </span> <a href="Ram.agc.html#414354495645">ACTIVE</a>                                <span class="co">#  Load whether game is active</span>
000934,000007:    5017           00006                           <span class="op">EXTEND  </span>                                       
000935,000008:    5020           15025                           <span class="op">BZF     </span> <a href="#43414E5F52454144">CAN_READ</a>                              <span class="co">#  If not active, we can accept key press to start the game</span>
000936,000009: 
000937,000010:    5021           30101                           <span class="op">CA      </span> <a href="Ram.agc.html#474D5F5354415445">GM_STATE</a>                              <span class="co">#  Load game state into A</span>
000938,000011:    5022           00006                           <span class="op">EXTEND  </span>                                       
000939,000012:    5023           15025                           <span class="op">BZF     </span> <a href="#43414E5F52454144">CAN_READ</a>                              <span class="co">#  If not 'check_key', we don't care about key presses</span>
000940,000013: 
000941,000014:    5024           15031                           <span class="op">TCF     </span> <a href="#4558495452555054">EXITRUPT</a>                              <span class="co">#  Exit, we're not listening for key presses while processing happens</span>
000942,000015: 
<a name="43414E5F52454144"></a>000943,000016:    5025                        <span class="sm">CAN_READ</span>                                                          
000944,000017: 
000945,000018:    5025           00006                           <span class="op">EXTEND  </span>                                       
000946,000019:    5026           00015                           <span class="op">READ    </span> <a href="Constants.agc.html#43483135">CH15</a>                                  <span class="co">#  Read I/O channel that contains the keycode</span>
000947,000020:    5027           75132                           <span class="op">MASK    </span> <a href="Constants.agc.html#4C4F5735">LOW5</a>                                  <span class="co">#  Retain only lower 5 bits</span>
000948,000021:    5030           54070                           <span class="op">TS      </span> <a href="Ram.agc.html#4B4559425546">KEYBUF</a>                                <span class="co">#  Store into keyboard buffer variable for main loop to pick up</span>
000949,000022: 
<a name="4558495452555054"></a>000950,000023:    5031                        <span class="sm">EXITRUPT</span>                                                          
000951,000024:    5031           30007                           <span class="op">CA      </span> <a href="Constants.agc.html#5A45524F4553">ZEROES</a>                                <span class="co">#  Clear the input channel</span>
000952,000025:    5032           00006                           <span class="op">EXTEND  </span>                                       
000953,000026:    5033           01015                           <span class="op">WRITE   </span> <a href="Constants.agc.html#43483135">CH15</a>                                  
000954,000027: 
000955,000028:    5034           52011                           <span class="op">DXCH    </span> <a href="Constants.agc.html#4152555054">ARUPT</a>                                 <span class="co">#  Restore A, L, and Q, and exit the interrupt</span>
000956,000029:    5035           00006                           <span class="op">EXTEND  </span>                                       
000957,000030:    5036           22012                           <span class="op">QXCH    </span> <a href="Constants.agc.html#5152555054">QRUPT</a>                                 
000958,000031:    5037           50017                           <span class="op">RESUME  </span>                                       
000959,000032: 
000960,000033: 
000961,000034: 
000962,000035: 
<a name="574149544B4559"></a>000963,000036:    5040                        <span class="sm">WAITKEY </span>                                                          <span class="co">#  Waiting for any key press to start game</span>
000964,000037:                                                                                                  <span class="co">#  If we didn't wait, the RNG would always start in same state</span>
000965,000038: 
000966,000039:    5040           35130                           <span class="op">CA      </span> <a href="Constants.agc.html#4E4F4B4559">NOKEY</a>                                 <span class="co">#  Load key code for 'no key pressed'</span>
000967,000040:    5041           00006                           <span class="op">EXTEND  </span>                                       
000968,000041:    5042           60070                           <span class="op">SU      </span> <a href="Ram.agc.html#4B4559425546">KEYBUF</a>                                <span class="co">#  Subtract the key code read</span>
000969,000042:    5043           00006                           <span class="op">EXTEND  </span>                                       
000970,000043:    5044           15051                           <span class="op">BZF     </span> <a href="#574149544D4F5245">WAITMORE</a>                              <span class="co">#  If zero, nothing pressed, continue waiting</span>
000971,000044: 
000972,000045:    5045           35130                           <span class="op">CA      </span> <a href="Constants.agc.html#4E4F4B4559">NOKEY</a>                                 <span class="co">#  Clear keyboard buffer so not carried into game</span>
000973,000046:    5046           54070                           <span class="op">TS      </span> <a href="Ram.agc.html#4B4559425546">KEYBUF</a>                                
000974,000047: 
000975,000048:    5047           35260                           <span class="op">CA      </span> <a href="Tables.agc.html#5354415F414444">STA_ADD</a>                               <span class="co">#  Set game state to add the two starting numbers and exit</span>
000976,000049:    5050           54101                           <span class="op">TS      </span> <a href="Ram.agc.html#474D5F5354415445">GM_STATE</a>                              
000977,000050: 
<a name="574149544D4F5245"></a>000978,000051:    5051                        <span class="sm">WAITMORE</span>                                                          
000979,000052:    5051           14070                           <span class="op">TCF     </span> <a href="Main.agc.html#4D41494E4C4F4F50">MAINLOOP</a>                              
000980,000053: 
000981,000054: 
000982,000055: 
<a name="434845434B5F4B45"></a>000983,000056:    5052                        <span class="sm">CHECK_KEY</span>                                                          <span class="co">#  Check whether key press in buffer from interrupt</span>
000984,000057: 
000985,000058:    5052           35130                           <span class="op">CA      </span> <a href="Constants.agc.html#4E4F4B4559">NOKEY</a>                                 <span class="co">#  Load key code for nothing pressed into A</span>
000986,000059:    5053           56070                           <span class="op">XCH     </span> <a href="Ram.agc.html#4B4559425546">KEYBUF</a>                                <span class="co">#  Swap A and buffer. A is now key code and buffer is clear.</span>
000987,000060:    5054           50000                           <span class="op">INDEX   </span> <a href="Constants.agc.html#41">A</a>                                     <span class="co">#  Index using the keycode</span>
000988,000061:    5055           15056                           <span class="op">TCF     </span> <a href="#4B45595441424C">KEYTABL</a>                               <span class="co">#  Into a jump table with jumps for each possible key</span>
000989,000062: 
000990,000063:                                                                                                  <span class="co">#  We ignore all presses except for 2, 4, 6, 8 for game control and ENTER/RESTART to reset game.</span>
<a name="4B45595441424C"></a>000991,000064:    5056                        <span class="sm">KEYTABL </span>                                                          
000992,000065:    5056           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
000993,000066:    5057           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  1</span>
000994,000067:    5060           14210                           <span class="op">TCF     </span> <a href="Down.agc.html#4D4F56455F444F57">MOVE_DOWN</a>                             <span class="co">#  2</span>
000995,000068:    5061           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  3</span>
000996,000069:    5062           14464                           <span class="op">TCF     </span> <a href="Left.agc.html#4D4F56455F4C4546">MOVE_LEFT</a>                             <span class="co">#  4</span>
000997,000070:    5063           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  5</span>
000998,000071:    5064           14574                           <span class="op">TCF     </span> <a href="Right.agc.html#4D4F56455F5254">MOVE_RT</a>                               <span class="co">#  6</span>
000999,000072:    5065           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  7</span>
001000,000073:    5066           14355                           <span class="op">TCF     </span> <a href="Up.agc.html#4D4F56455F5550">MOVE_UP</a>                               <span class="co">#  8</span>
001001,000074:    5067           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  9</span>
001002,000075:    5070           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001003,000076:    5071           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001004,000077:    5072           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001005,000078:    5073           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001006,000079:    5074           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001007,000080:    5075           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001008,000081:    5076           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  0</span>
001009,000082:    5077           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  VERB</span>
001010,000083:    5100           14054                           <span class="op">TCF     </span> <a href="Main.agc.html#494E4954">INIT</a>                                  <span class="co">#  RSET</span>
001011,000084:    5101           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001012,000085:    5102           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001013,000086:    5103           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001014,000087:    5104           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001015,000088:    5105           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001016,000089:    5106           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001017,000090:    5107           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  KEY REL</span>
001018,000091:    5110           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  +</span>
001019,000092:    5111           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  -</span>
001020,000093:    5112           14054                           <span class="op">TCF     </span> <a href="Main.agc.html#494E4954">INIT</a>                                  <span class="co">#  ENTR</span>
001021,000094:    5113           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  unused</span>
001022,000095:    5114           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  CLR</span>
001023,000096:    5115           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  NOUN</span>
001024,000097:    5116           15117                           <span class="op">TCF     </span> <a href="#454E444B59434B">ENDKYCK</a>                               <span class="co">#  NOKEY</span>
001025,000098: 
<a name="454E444B59434B"></a>001026,000099:    5117                        <span class="sm">ENDKYCK </span>                                                          
001027,000100:    5117           14070                           <span class="op">TCF     </span> <a href="Main.agc.html#4D41494E4C4F4F50">MAINLOOP</a>                              <span class="co">#  When we do nothing, just exit back to main loop to wait for a valid key</span>
001028,000101: 

End of include-file Input.agc.  Parent file is <a href="Main.agc.html">Main.agc</a>
</pre>
</span>
</p>
</body>
</html>
